#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
-------------------------------------------------

    @   Author  :       pengj
    @   date    :       2018/12/9 13:19
    @   IDE     :       PyCharm
    @   GitHub  :       https://github.com/JackyPJB
    @   Contact :       pengjianbiao@hotmail.com
-------------------------------------------------
    Description :  947. 移除最多的同行或同列石头

    用户通过次数 11
    用户尝试次数 32
    通过次数 11
    提交次数 68
    题目难度 Medium

在二维平面上，我们将石头放置在一些整数坐标点上。每个坐标点上最多只能有一块石头。

现在，move 操作将会移除与网格上的某一块石头共享一列或一行的一块石头。

我们最多能执行多少次 move 操作？



示例 1：

输入：stones = [[0,0],[0,1],[1,0],[1,2],[2,1],[2,2]]
输出：5

示例 2：

输入：stones = [[0,0],[0,2],[1,1],[2,0],[2,2]]
输出：3

示例 3：

输入：stones = [[0,0]]
输出：0



提示：

    1 <= stones.length <= 1000
    0 <= stones[i][j] < 10000
-------------------------------------------------
"""
import time

__author__ = 'Max_Pengjb'
start_time = time.time()


# 下面写上代码块
class DSU:
    def __init__(self, N):
        self.p = [i for i in range(N)]

    def find(self, x):
        if self.p[x] != x:
            self.p[x] = self.find(self.p[x])
        return self.p[x]

    def union(self, x, y):
        xr = self.find(x)
        yr = self.find(y)
        self.p[xr] = yr


class Solution(object):
    def removeStones(self, stones):
        N = len(stones)
        dsu = DSU(20000)
        for x, y in stones:
            dsu.union(x, y + 10000)

        return N - len({dsu.find(x) for x, y in stones})


stones_in = [[246, 1187], [8516, 28], [3906, 3850], [8152, 110], [9451, 3028], [3208, 7995], [9418, 8131], [8371, 4872],
             [638, 9236], [9446, 8739], [1071, 1117], [2655, 3192], [3886, 2286], [5310, 5830], [7413, 9428],
             [9721, 5689], [4808, 8882], [1296, 967], [451, 6026], [6553, 6991], [9904, 5132], [6983, 4110],
             [4725, 1750], [5980, 1290], [7183, 5756], [4325, 4341], [7493, 8694], [1140, 8452], [3386, 5580],
             [1026, 7377], [6319, 9905], [4860, 473], [6404, 3588], [1618, 6118], [1640, 7237], [7768, 2634],
             [546, 3153], [3055, 6073], [6169, 6546], [3870, 6955], [8509, 3767], [4793, 6517], [7158, 4993],
             [6517, 5895], [9334, 5472], [7853, 3321], [5779, 6723], [956, 5293], [2007, 2936], [2696, 3363],
             [5734, 135], [5354, 6663], [2209, 3143], [5353, 6556], [9346, 5571], [1206, 9725], [7828, 9166],
             [8335, 5888], [9365, 707], [959, 5208], [2922, 2228], [7978, 7266], [8091, 4737], [9193, 4852], [24, 3740],
             [9997, 4892], [6808, 2187], [7690, 1321], [2939, 3833], [1030, 9759], [7268, 1872], [3732, 4367],
             [8812, 6696], [3172, 6749], [2830, 6492], [5123, 7216], [5471, 2495], [1306, 6927], [7616, 4155],
             [9277, 4138], [6393, 3609], [8510, 2556], [1226, 1678], [6553, 6868], [4920, 1024], [7235, 9410],
             [6236, 4612], [3600, 8170], [6042, 4472], [3974, 5461], [836, 524], [9010, 8243], [7797, 8365],
             [1340, 3064], [4924, 5791], [6246, 3752], [4, 6232], [7091, 936], [9844, 4323], [6301, 4318], [4375, 8702],
             [50, 8241], [6669, 2885], [2643, 9474], [588, 3100], [9393, 1562], [9190, 1872], [5822, 6139], [2693, 133],
             [5249, 2892], [2967, 9227], [519, 6962], [4937, 1145], [9582, 4509], [379, 2081], [3114, 36], [4538, 8897],
             [9525, 3483], [9414, 2029], [7214, 7380], [3254, 8728], [9624, 5781], [7670, 8208], [655, 102],
             [6920, 2685], [9037, 6461], [1334, 4353], [1134, 10], [251, 379], [218, 8358], [4319, 8095], [3182, 9532],
             [2010, 7637], [5277, 3058], [2977, 8217], [680, 4599], [5656, 8190], [7352, 9742], [9055, 2583],
             [4560, 4212], [646, 7070], [7566, 6825], [862, 3886], [5671, 2459], [2268, 9576], [3667, 2654],
             [5828, 4029], [7311, 7897], [131, 3456], [7080, 1237], [6409, 6038], [5218, 2147], [5125, 4481],
             [5659, 1622], [2565, 5571], [4231, 487], [8293, 5784], [5617, 1336], [1164, 8043], [5372, 7718],
             [5245, 272], [36, 2185], [1156, 4168], [6846, 8436], [6070, 210], [8845, 7443], [2563, 5872], [3227, 3906],
             [2320, 3783], [3779, 377], [6516, 2238], [7615, 1708], [6203, 4043], [636, 2890], [4869, 8060],
             [2647, 4534], [6860, 6562], [1407, 5910], [7352, 5282], [3361, 5483], [8642, 2121], [5599, 2574],
             [9710, 5210], [4226, 7843], [9106, 9046], [1891, 1292], [7979, 3205], [8956, 8552], [174, 7924],
             [5269, 4981], [2357, 7163], [6251, 841], [5881, 9210], [5374, 6462], [5194, 6272], [6472, 9390],
             [4328, 5912], [6429, 5501], [716, 7500], [2972, 546], [7177, 1643], [9228, 830], [6624, 1503],
             [7216, 8724], [277, 309], [9168, 1695], [4586, 1626], [7497, 2700], [2860, 9646], [6511, 1308],
             [7680, 8870], [7866, 7281], [9854, 3812], [9117, 4548], [2080, 6903], [8022, 4977], [4159, 9690],
             [7918, 4678], [9629, 5424], [1373, 2463], [1087, 5842], [652, 8301], [7471, 163], [9461, 5116],
             [1600, 1656], [2085, 9938], [7180, 9450], [8172, 3031], [1985, 8095], [3394, 6883], [7113, 2001],
             [9315, 3940], [9350, 568], [2632, 1134], [4538, 8667], [7884, 8224], [9239, 939], [7205, 3790],
             [8476, 577], [2054, 4568], [9368, 7947], [4019, 2930], [7312, 3743], [1270, 6479], [5423, 1228],
             [8291, 5429], [2053, 9083], [6794, 1795], [4426, 3051], [4550, 5085], [3167, 7023], [6706, 2970],
             [1756, 9922], [362, 2133], [417, 9417], [9407, 2499], [3312, 6450], [1320, 214], [816, 4642], [9750, 5927],
             [45, 5153], [8145, 179], [4266, 3888], [2423, 3971], [5704, 5071], [5416, 3117], [5398, 2057],
             [8079, 8925], [8433, 3342], [9622, 3262], [3790, 8444], [1944, 7963], [5324, 1624], [7726, 4131],
             [1303, 7117], [4747, 8428], [3388, 919], [9368, 8335], [3610, 4773], [1067, 6259], [5810, 4601],
             [9352, 6069], [5845, 4141], [9922, 8834], [4405, 6833], [4615, 4214], [2486, 3712], [7193, 2079],
             [1861, 1191], [1477, 2806], [7083, 5135], [6271, 6301], [1213, 5949], [3113, 852], [7920, 1699],
             [1899, 6088], [4423, 8209], [9509, 7524], [9765, 3335], [1150, 9893], [5006, 1637], [1203, 3896],
             [4943, 6886], [272, 9429], [3700, 5173], [9219, 4564], [5180, 86], [783, 722], [2488, 38], [6470, 2081],
             [148, 2762], [756, 6982], [9531, 6085], [8779, 9711], [671, 4812], [3351, 7241], [5488, 4807],
             [8390, 7945], [3482, 9716], [4118, 4155], [7157, 200], [4546, 2937], [9591, 5425], [4663, 3563],
             [4526, 1158], [8338, 885], [3948, 1487], [5406, 7944], [4126, 586], [6124, 4208], [941, 5730],
             [5347, 5560], [3101, 1788], [599, 7466], [1459, 6461], [4671, 2688], [6044, 8694], [503, 275],
             [5107, 1417], [6839, 9687], [5634, 4047], [6422, 9033], [9181, 954], [5007, 9164], [6936, 8691],
             [2873, 1400], [6696, 7968], [633, 3610], [5771, 9458], [9261, 4842], [2415, 888], [7648, 6381],
             [2010, 745], [9214, 2902], [6110, 6079], [6513, 3801], [8210, 850], [4309, 4186], [5588, 9430],
             [3763, 7376], [1168, 7969], [3767, 9059], [685, 7943], [9835, 4425], [4685, 7592], [6910, 3876],
             [5129, 6854], [2907, 8695], [2226, 4793], [8586, 5132], [9185, 577], [7550, 9509], [9833, 5696],
             [5711, 8118], [8289, 3311], [3908, 3980], [6604, 8208], [8430, 4660], [9285, 3230], [2096, 9957],
             [550, 6400], [1112, 9420], [8145, 1837], [4926, 3282], [6009, 1654], [4428, 6572], [5672, 2574],
             [336, 6262], [212, 7676], [1559, 5682], [6588, 3460], [2906, 1121], [4417, 1104], [8903, 4978],
             [3950, 3869], [4980, 7533], [7160, 4222], [7123, 4978], [171, 7870], [6507, 8098], [7593, 5027],
             [162, 628], [9943, 3534], [4190, 6526], [4574, 1004], [7745, 9744], [208, 5024], [1085, 376], [6024, 7866],
             [4336, 1868], [5559, 5253], [1910, 332], [3502, 3079], [5370, 8583], [1696, 8084], [1879, 1749],
             [5192, 7738], [1771, 3181], [7290, 9596], [5726, 1994], [9549, 1405], [4541, 5873], [9360, 9005],
             [5564, 3109], [1961, 8621], [766, 1690], [7020, 557], [7671, 8029], [3829, 905], [1186, 6971],
             [9319, 7790], [1281, 6446], [2084, 4784], [9105, 1680], [7513, 6110], [3358, 8130], [2688, 3789],
             [674, 724], [2972, 9006], [630, 157], [7048, 8357], [2968, 1634], [2448, 1521], [6338, 3691], [3636, 4510],
             [1561, 8749], [7455, 9549], [6800, 8559], [1590, 8542], [1402, 3351], [6164, 3074], [4557, 7588],
             [2917, 8792], [2091, 2365], [7669, 8670], [1877, 2559], [8774, 1452], [1654, 225], [7767, 95],
             [8493, 1784], [3610, 8410], [259, 9074], [9350, 1107], [8032, 7142], [8757, 8744], [8767, 6124],
             [3106, 856], [5818, 2637], [117, 3813], [8208, 3057], [1078, 8451], [1855, 658], [2073, 2015],
             [3423, 7955], [563, 3404], [3983, 971], [7112, 6181], [3139, 7579], [869, 7173], [1300, 2964],
             [5588, 1515], [789, 2865], [1853, 2693], [6172, 5260], [3552, 7215], [8689, 221], [9055, 3214],
             [5735, 4374], [6044, 7385], [4034, 9852], [3356, 7645], [9049, 7270], [887, 341], [9098, 315],
             [2981, 7848], [4772, 2976], [9994, 3973], [3838, 5429], [4259, 1559], [2011, 6454], [4296, 1661],
             [4706, 379], [1547, 8516], [7628, 9261], [7864, 2832], [4970, 5299], [6438, 2494], [496, 3215],
             [6038, 490], [866, 6596], [8318, 6932], [6372, 4977], [9326, 1516], [3567, 8989], [4400, 8562],
             [7918, 5233], [1204, 9432], [6726, 9252], [7925, 3093], [6568, 7468], [8409, 1132], [3543, 3566],
             [1913, 769], [670, 2008], [3469, 5996], [2068, 8150], [2000, 7615], [5799, 9101], [3427, 3838],
             [6546, 3464], [9318, 271], [4914, 6927], [6002, 3054], [2177, 5231], [163, 2984], [5903, 4584],
             [7368, 3986], [3777, 6977], [3194, 89], [6493, 9054], [135, 1819], [568, 8078], [4048, 4160], [4787, 2733],
             [3684, 3627], [241, 1491], [2359, 3255], [6754, 6218], [2469, 4742], [744, 4466], [7984, 2105],
             [3718, 8087], [973, 9450], [5268, 1454], [2399, 2003], [4083, 7524], [5562, 5841], [9245, 70],
             [7268, 5105], [2298, 4965], [9293, 9258], [329, 5109], [755, 4251], [6938, 2853], [5872, 1850],
             [2103, 6906], [1872, 9820], [7571, 5096], [5586, 9133], [5853, 62], [342, 5489], [7266, 2189],
             [4030, 6835], [162, 6798], [3203, 7096], [1795, 8824], [4627, 5702], [2418, 1649], [4051, 7593],
             [2398, 6078], [1084, 1447], [9214, 967], [2301, 7900], [8373, 5110], [7660, 69], [401, 597], [5595, 8491],
             [6631, 3953], [3198, 1220], [5920, 8737], [7359, 826], [6802, 7997], [8750, 7121], [4412, 5448],
             [7907, 9873], [2609, 2222], [4851, 7113], [6878, 9263], [2971, 2238], [5816, 8751], [1622, 3913],
             [5597, 9346], [9814, 1128], [4964, 4163], [4853, 7509], [4240, 7453], [645, 7533], [8618, 4971],
             [5643, 2635], [2053, 9483], [2905, 4818], [628, 2899], [9106, 4848], [1514, 1243], [4489, 6943],
             [4829, 8075], [7034, 7372], [6202, 8341], [1258, 6488], [3936, 7568], [6969, 6721], [9688, 5267],
             [5909, 1915], [6986, 4396], [4212, 893], [9488, 8370], [1194, 7653], [4272, 7232], [109, 1908],
             [2096, 1453], [4100, 678], [7991, 8593], [2046, 8028], [6997, 9606], [4723, 6046], [712, 3618],
             [1408, 7937], [1028, 1297], [5166, 9624], [9833, 3249], [5212, 9009], [6854, 2246], [8833, 3374],
             [7973, 2675], [5092, 1370], [4303, 9126], [6808, 8618], [1256, 7203], [2777, 2411], [4472, 4476],
             [8116, 4289], [4111, 1407], [2720, 3784], [7870, 1063], [2677, 9784], [9626, 9304], [8064, 5450],
             [9945, 6485], [5559, 6662], [6790, 7974], [160, 3949], [2925, 3451], [3232, 1285], [9611, 1272],
             [5230, 4502], [6340, 6973], [2819, 1167], [5132, 1839], [1888, 1120], [688, 4639], [8896, 4052],
             [2769, 3540], [5467, 4177], [8959, 8163], [753, 1456], [4909, 6576], [851, 9645], [5866, 8509],
             [3381, 7041], [9570, 5525], [418, 6516], [4053, 4391], [3131, 8880], [8963, 2139], [8292, 1191],
             [5694, 4142], [4840, 8747], [2937, 2838], [6943, 6730], [6544, 9797], [8319, 7280], [7618, 2804],
             [9164, 5744], [8411, 7926], [7572, 9719], [977, 1385], [7644, 5654], [6805, 7080], [8070, 4265],
             [6932, 2147], [4185, 3032], [9007, 8031], [8296, 232], [4160, 4855], [5695, 5792], [1709, 5238],
             [9467, 1529], [9424, 4645], [2887, 8762], [9521, 4733], [7477, 7112], [2118, 4254], [9774, 4704],
             [1740, 9611], [8996, 9268], [7637, 4666], [7984, 6779], [4529, 3670], [6162, 137], [3930, 2887],
             [5433, 6141], [9015, 1937], [3247, 948], [3866, 5731], [5242, 1771], [706, 4386], [547, 8058], [133, 1533],
             [5685, 2676], [4091, 6027], [1842, 7209], [898, 7022], [6875, 8665], [8112, 8153], [3325, 6393],
             [4932, 7179], [9121, 8370], [5584, 7214], [3243, 4530], [5558, 5613], [7656, 3303], [7921, 685],
             [5708, 9939], [9572, 6904], [1869, 9055], [7790, 6780], [4147, 3794], [8329, 2812], [2725, 6591],
             [1335, 7759], [1094, 5798], [8087, 3638], [5747, 6254], [7514, 6092], [7188, 5676], [3164, 1928],
             [4263, 5651], [3000, 4616], [6683, 3324], [5243, 6432], [2067, 5458], [4063, 6152], [3767, 8799],
             [2181, 8313], [2240, 6585], [4591, 8757], [3193, 7257], [799, 7298], [8059, 9335], [5230, 4264],
             [6071, 9861], [4145, 8668], [7814, 332], [4626, 1025], [3883, 42], [2382, 793], [8258, 1229], [5951, 9367],
             [6130, 5951], [3711, 8475], [3760, 3412], [4024, 8065], [2106, 953], [5460, 4757], [7058, 3196],
             [2792, 1403], [5311, 2559], [9632, 1244], [9145, 2643], [6859, 5781], [3206, 7291], [4597, 2520],
             [769, 1529], [8127, 4115], [4486, 8686], [6909, 3656], [5453, 2725], [1262, 9581], [175, 7720],
             [5918, 4197], [6122, 2015], [286, 7098], [1361, 1030], [9416, 5986], [3048, 2455], [1680, 6785],
             [4009, 6406], [6960, 5644], [4988, 6533], [6546, 7424], [193, 8344], [3403, 2920], [5168, 7380],
             [985, 4103], [5618, 8541], [9803, 8436], [7676, 3822], [1638, 655], [7288, 2014], [1389, 3171],
             [7978, 4519], [5519, 4131], [7796, 3878], [1667, 8689], [5064, 3438], [8287, 4008], [6354, 5647],
             [5249, 93], [7922, 322], [8734, 5748], [4315, 7597], [7589, 5230], [7176, 7389], [1685, 7474],
             [6189, 7381], [3891, 3829], [5442, 2236], [1450, 2808], [9154, 8418], [8573, 6767], [3769, 3191],
             [8236, 9422], [4996, 5538], [2596, 9825], [3305, 4140], [7620, 893], [2537, 7253], [5290, 7398],
             [4849, 9538], [4414, 6993], [2589, 5816], [4125, 1070], [974, 4229], [4704, 5677], [6283, 6230],
             [578, 8589], [910, 1833], [899, 6404], [4986, 1874], [8219, 302], [6136, 8987], [3223, 1591], [7033, 4897],
             [9233, 8592], [3227, 8457], [2964, 7993], [4702, 5781], [9482, 2755], [801, 6075], [4777, 8636],
             [9139, 7450], [9195, 6779], [3231, 9013], [9845, 2042], [4823, 6257], [6078, 4596], [390, 5610],
             [3929, 3161], [6033, 7482], [9454, 6306], [2329, 3369], [5197, 7394], [1881, 5848], [4292, 5585],
             [7768, 4655], [2532, 6469], [8639, 7734], [854, 6397], [2200, 7715], [6633, 7961], [2402, 1735],
             [8722, 8141], [2898, 2665], [669, 6824], [92, 7522], [6513, 4131], [5284, 1209], [8638, 4677],
             [5265, 3255], [4880, 8590], [4228, 4043], [4497, 9298], [1371, 8567], [8263, 5662], [8660, 4873],
             [7398, 745], [4207, 2398], [1466, 6178], [6386, 6480], [5108, 5799], [2886, 7017], [4748, 3323],
             [2646, 5904], [4817, 6552], [7323, 1310], [4236, 1610], [3891, 5610], [5292, 8982], [4184, 5982],
             [5013, 9320], [4892, 2188], [6338, 3802], [6089, 725], [8798, 1879], [8316, 8237], [200, 8272],
             [772, 1665], [5339, 1283], [6263, 5232], [1162, 4464], [6019, 3752], [8275, 5775], [5735, 9745],
             [2431, 6951], [3556, 3858], [4388, 1391], [9870, 6957], [5010, 7947], [6775, 9479], [5925, 1296],
             [2240, 3028], [3407, 4234], [7804, 8598], [6232, 8918], [70, 1131], [9162, 7568], [6224, 2499],
             [7215, 3509], [1489, 5388], [5913, 6406], [2833, 6983], [5826, 1544], [5793, 6789], [1401, 1717],
             [4029, 2543], [9254, 8452], [5719, 2505], [6314, 2945], [7776, 7337], [1754, 6004], [3212, 2452],
             [8850, 4748], [2379, 2907], [7211, 2405], [325, 3798], [4840, 3630], [9860, 3728], [4056, 7673],
             [2994, 7969], [1558, 9207], [9101, 2161], [4721, 888], [5330, 678], [4484, 9109], [7339, 8813],
             [9590, 6968], [2350, 2523], [8791, 7008], [1421, 1822], [1810, 2155], [2678, 3031], [899, 2528],
             [1340, 3695], [434, 9882], [2360, 878], [1814, 6610], [8957, 6914], [2889, 4836], [3128, 9772],
             [6272, 3406], [5979, 3155], [9020, 7725], [5899, 7121], [1286, 6189], [9043, 5354], [838, 8561],
             [3179, 1485], [6453, 931], [3658, 8952], [7784, 5542]]
res = Solution().removeStones(stones_in)
print(res)
# 上面中间写上代码块
end_time = time.time()
print('Running time: %s Seconds' % (end_time - start_time))
